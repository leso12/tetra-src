<!DOCTYPE html>
<html>
<head>
    <title>ANI ROS TEST</title>
    <meta charset="UTF-8">
    <style>
        body { font-family: sans-serif; text-align: center; }

    /* 전체 페이지 중앙 정렬을 위한 컨테이너 */
    .page-wrapper {
        display: flex;
        flex-direction: column;
        align-items: center; /* 모든 내용을 가로 중앙에 정렬 */
        max-width: 1920px; /* 전체 너비 제한 (선택 사항) */
        margin: 0 auto; /* 페이지 중앙 정렬 */
    }

    /* 줌 컨트롤 */
    .zoom-controls {
        margin-bottom: 20px;
    }
    .zoom-controls button {
        background-color: #f0f0f0;
        border: 1px solid #ccc;
        border-radius: 5px;
        padding: 8px 15px;
        font-size: 1.2em;
        cursor: pointer;
        transition: background-color 0.2s;
    }
    .zoom-controls button:hover {
        background-color: #e0e0e0;
    }

    /* 맵과 사이드 패널을 나란히 배치할 메인 컨테이너 */
    .main-content-container {
        display: flex;
        justify-content: center; /* 가로 중앙 정렬 */
        align-items: flex-start; /* 세로 상단 정렬 (컨텐츠 길이에 맞춰) */
        gap: 20px; /* 맵과 오른쪽 패널 사이의 간격 */
        margin-top: 20px;
        margin-bottom: 20px; /* 이동 버튼과의 간격 */
    }

    /* 맵 캔버스 컨테이너 */
    .canvas-container {
        position: relative;
        width: 1000px;
        height: 700px;
        border: 1px solid #ccc;
        transition: width 0.2s ease-in-out, height 0.2s ease-in-out;
        overflow: hidden;
        display: flex;
        justify-content: center;
        align-items: center;
    }
    #mapCanvas {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        image-rendering: pixelated;
        z-index: 1;
    }

    /* 오른쪽 섹션 (로봇 정보표 + 로봇 선택 드롭다운 + 로봇 이동 버튼) */
    .right-panel-container {
        display: flex;
        flex-direction: column; /* 내부 요소를 세로로 정렬 */
        align-items: center; /* 가운데 정렬 */
        gap: 20px; /* 각 섹션 (표, 선택, 이동 버튼) 사이의 간격 */
        width: 700px; /* 오른쪽 패널 전체의 너비 통일 */
    }

    /* 로봇 위치 정보 표 스타일 */
    .robot-info-panel {
        width: 100%; /* right-panel-container 너비에 맞춤 */
        border: 1px solid #ccc;
        padding: 15px;
        background-color: #f9f9f9;
        box-shadow: 2px 2px 5px rgba(0,0,0,0.1);
    }
    .robot-info-panel h2 {
        margin-top: 0;
        font-size: 1.3em;
        color: #333;
    }
    .robot-info-table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 10px;
    }
    .robot-info-table th,
    .robot-info-table td {
        border: 1px solid #ddd;
        padding: 8px;
        text-align: center;
        font-size: 0.9em;
    }
    .robot-info-table th {
        background-color: #e0e0e0;
        font-weight: bold;
    }

    /* 로봇 선택 드롭다운 컨테이너 */
    .robot-selection-container {
        width: 100%; /* right-panel-container 너비에 맞춤 */
        padding: 15px;
        border: 1px solid #ccc;
        background-color: #f9f9f9;
        box-shadow: 2px 2px 5px rgba(0,0,0,0.1);
        text-align: center;
    }
    .robot-selection-container label {
        font-weight: bold;
        margin-right: 10px;
        font-size: 1.3em;
    }
    .robot-selection-container select {
        padding: 5px;
        border-radius: 5px;
        border: 1px solid #ccc;
        width: 400px;
        height: 40px;
        font-size: 1.2em;
        text-align: center;
        text-align-last: center; /* IE/Edge 호환성을 위해 추가 */
    }

    .robot-info-table th:last-child,
    .robot-info-table td:last-child {
        width: 80px; /* 적절한 너비로 조절하세요 (예: 70px, 80px, 90px 등) */
        min-width: 80px; /* 최소 너비도 함께 지정하여 내용이 넘치지 않도록 합니다 */
    }
    /* 로봇 X, Y, Yaw 컬럼도 너비를 고정하는 것이 안정적입니다. */
    .robot-info-table td[id$="_x"],
    .robot-info-table td[id$="_y"],
    .robot-info-table td[id$="_yaw"] {
        width: 70px; /* X, Y, Yaw 값에 맞는 적절한 너비 */
        min-width: 70px;
    }

    /* 로봇 이동 제어 버튼 컨테이너 */
    .control-buttons-container {
        width: 100%; /* right-panel-container 너비에 맞춤 */
        display: flex;
        flex-direction: column; /* 버튼 행들을 세로로 정렬 */
        align-items: center; /* 각 행을 가운데 정렬 */
        gap: 5px; /* 버튼 행 사이의 간격 */
        border: 1px solid #ccc;
        padding: 15px;
        background-color: #f9f9f9;
        box-shadow: 2px 2px 5px rgba(0,0,0,0.1);
    }

    /* 버튼 컨테이너 스타일 */
    .button-row {
        display: flex; /* Flexbox 레이아웃 사용 */
        justify-content: center; /* 가로 방향으로 가운데 정렬 */
        align-items: center; /* 세로 방향으로 가운데 정렬 (선택 사항) */
        margin: 5px 0; /* 위아래 마진 */
    }

    /* 고정 크기 버튼 스타일 */
    .control-button {
        width: 80px;
        height: 40px;
        padding: 10px 20px;
        font-size: 13px;
        margin: 0px 40px;
        background-color: #a0a0a0; /* 회색 */
        color: white; /* 텍스트 색상 */
        border: none;
        border-radius: 5px;
        cursor: pointer;
        transition: background-color 0.2s;
        display: flex; /* Flex 컨테이너로 설정 */
        justify-content: center; /* 가로 방향 가운데 정렬 */
        align-items: center; /* 세로 방향 가운데 정렬 */
    }
    .control-button:hover {
        background-color: #808080; /* 더 진한 회색 */
    }

    /* 특정 버튼 행의 justify-content 조정 */
    .button-row.horizontal-center {
        justify-content: center;
    }
    .button-row.horizontal-spread {
        justify-content: space-around; /* 좌우 버튼을 더 넓게 펼침 */
        width: 100%; /* 부모 너비에 맞춤 */
    }

    /* 로봇 상태 셀 스타일 (선택 사항) */
    .robot-info-table td[id$="_status"] { /* ID가 "_status"로 끝나는 모든 td에 적용 */
        color: #333; /* 기본 텍스트 색상 */
    }
    /* 이동 중 상태 */
    .robot-info-table td[id$="_status"].moving {
        color: black;
    }
    /* 정지 상태 */
    .robot-info-table td[id$="_status"].stopped {
        color: black;
    }

    </style>
</head>
<body>
    <div class="page-wrapper">
        <h1>ROS 실시간 화면</h1>

        <div class="zoom-controls">
            <button onclick="zoomOut()">-</button>
            <button onclick="zoomIn()">+</button>
        </div>

        <div class="main-content-container">
            <div class="canvas-container">
                <canvas id="mapCanvas"></canvas>
            </div>

            <div class="right-panel-container">
                <div class="robot-info-panel">
                    <h2>로봇 위치 정보</h2>
                    <table class="robot-info-table">
                        <thead>
                            <tr>
                                <th rowspan="2">로봇</th></tr>
                            <tr>
                                <th>X (m)</th>
                                <th>Y (m)</th>
                                <th>Yaw (°)</th>
                                <th>상 태</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr id="robot1_row">
                                <td>로봇 1</td>
                                <td id="robot1_x">0.00</td>
                                <td id="robot1_y">0.00</td>
                                <td id="robot1_yaw">0.00</td>
                                <td id="robot1_status" class="stopped">정지</td> </tr>
                            <tr id="robot2_row">
                                <td>로봇 2</td>
                                <td id="robot2_x">0.00</td>
                                <td id="robot2_y">0.00</td>
                                <td id="robot2_yaw">0.00</td>
                                <td id="robot2_status" class="stopped">정지</td> </tr>
                            <tr id="robot3_row">
                                <td>로봇 3</td>
                                <td id="robot3_x">0.00</td>
                                <td id="robot3_y">0.00</td>
                                <td id="robot3_yaw">0.00</td>
                                <td id="robot3_status" class="stopped">정지</td> </tr>
                        </tbody>
                    </table>
                </div>

                <div class="robot-selection-container">
                    <label for="robotSelector">로봇 선택:</label>
                    <select id="robotSelector" onchange="updateSelectedRobot()">
                        <option value="/robot1/cmd_vel" data-tf-frame="/robot1/base_link">로봇 1</option>
                        <option value="/robot2/cmd_vel" data-tf-frame="/robot2/base_link">로봇 2</option>
                        <option value="/robot3/cmd_vel" data-tf-frame="/robot3/base_link">로봇 3</option>
                    </select>
                </div>

                <div class="control-buttons-container">
                    <div class="button-row horizontal-center">
                        <button class="control-button" onmousedown="startMove('forward')" onmouseup="stopMove()" ontouchstart="startMove('forward')" ontouchend="stopMove()">전 진</button>
                    </div>
                    <div class="button-row horizontal-spread">
                        <button class="control-button" onmousedown="startMove('left')" onmouseup="stopMove()" ontouchstart="startMove('left')" ontouchend="stopMove()">좌회전</button>
                        <button class="control-button" onmousedown="startMove('right')" onmouseup="stopMove()" ontouchstart="startMove('right')" ontouchend="stopMove()">우회전</button>
                    </div>
                    <div class="button-row horizontal-center">
                        <button class="control-button" onmousedown="startMove('backward')" onmouseup="stopMove()" ontouchstart="startMove('backward')" ontouchend="stopMove()">후 진</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="./roslibjs-1.4.1/build/roslib.min.js"></script>
    <script src="robot_control.js"></script>
</body>
</html>